define(["exports"],function(t){"use strict";function n(t,o){if("function"!=typeof o){if(Array.isArray(o))return o.map(e=>n(t,e));{const e={};for(const[i,s]of Object.entries(o))"function"==typeof s&&(e[i]=n(t,s));return e}}const i=class extends o{subscribe(t){}componentWillMount(){super.componentWillMount(),e(this),this.evt_sink.emit("will_mount")}componentDidMount(){this.evt_sink.emit("did_mount")}componentWillUnmount(){this.evt_sink.emit("will_unmount").clear()}get evt_sink(){return t.sink(this)}};return i.prototype.evtbus=t,i}function e(t,n){null==t.state&&(t.state={});const e=[];t.evt_sink.on("will_mount",function(){const o=n?n.call(t,t.props,t):t.subscribe(t.props);t.setState(o,function(){for(const[n,i]of Object.entries(o)){if(null==i||"function"!=typeof i.subscribe)throw new TypeError(`Subscription "${n}" does not have a subscribe() function`);e.push(i.subscribe(!1,e=>{t.setState(t=>e!==t[n]?{[n]:e}:null)}))}})}).on("will_unmount",function(){for(const t of e.splice(0,e.length))t()})}t.withSubscribe=n,t.bindSubscriptions=e,Object.defineProperty(t,"__esModule",{value:!0})});
