define(["exports"],function(t){"use strict";function s(t){const s="function"==typeof t.subscriptions?t.subscriptions(t.props):t.subscriptions;if(null==s)return;const e={},n=[];let i=null;for(const[o,r]of Object.entries(s)){if(null==r||"function"!=typeof r.subscribe)throw new TypeError(`Subscription "${o}" does not have a subscribe() function`);n.push(r.subscribe(s=>{e[o]=s,null===i&&(i=Promise.resolve().then(()=>{t.setSubscriptionState(e),i=null}))}))}t.setSubscriptionState(e,function(){for(const t of n.splice(0,n.length))t()})}t.withSubscribe=function(t,e){const n=class extends e{constructor(...t){var s;return s=super(...t),this.state=this.state||{},s}subscriptions(t){}setSubscriptionState(t,s){void 0!==s?(Object.assign(this.state,t),this.evt_sink.on("cleanup",s)):this.setState(t)}componentWillMount(){s(this)}componentWillUnmount(...t){this.evt_sink.emit("cleanup").clear()}get evt_sink(){return t.sink(this)}};return n.prototype.evtbus=t,n},t.bindSubscriptions=s,Object.defineProperty(t,"__esModule",{value:!0})});
