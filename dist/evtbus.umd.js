!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.evtbus=t()}(this,function(){"use strict";function e(){function e(e,n){if(null==e)throw new TypeError("Invalid topic");let o=t.get(e);return void 0===o&&(o=Object.create(null),t.set(e,o)),void 0===n?o:o[n]||(o[n]=[])}const t=new Map,n=new WeakMap;return{topic:function(n){return{emit(t,o){const i=e(n),f=i[t],c=i["*"];if(void 0!==f)for(const e of f)e(o);if(void 0!==c)for(const e of c)e(o,t)},clear(e){const o=t.get(n);if(void 0!==o){e&&t.delete(n);for(const[e,t]of Object.entries(o)){delete o[e];for(const e of t)e.fn=e.lst=null}}}}},sink:function(t){function o(i,f,c){if("function"!=typeof c)throw new TypeError("Expected function");let r=n.get(t);void 0===r&&(r=new Set,n.set(t,r));const s=e(i,f);return r.add({fn:c,lst:s}),s.push(c),o}return o.subscribe=o,o.clear=function(){const e=n.get(t);if(void 0!==e){n.delete(t);for(const{lst:t,fn:n}of e)t&&t.splice(t.indexOf(n)>>>0,1);e.clear()}},o}}}return Object.assign(e,e()),e});
